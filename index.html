<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Meine Songliste</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0; 
      display: flex; 
      flex-direction: column; 
      min-height: 100vh;
    }
    header {
      background: #007acc;
      color: white;
      padding: 1rem;
      text-align: center;
      font-size: 1.5rem;
      font-weight: bold;
    }
    #songlist, #songdetail {
      padding: 1rem;
      flex-grow: 1;
      overflow-y: auto;
    }
    #songlist table {
      width: 100%;
      border-collapse: collapse;
    }
    #songlist th, #songlist td {
      border: 1px solid #ccc;
      padding: 0.5rem;
      text-align: left;
    }
    #songlist tr:hover {
      background-color: #eef;
      cursor: pointer;
    }
    #songdetail {
      display: none;
      white-space: pre-wrap; /* für Zeilenumbrüche im Songtext */
      font-family: monospace; /* für Akkorde im Text */
    }
    button#backBtn {
      margin-bottom: 1rem;
      padding: 0.5rem 1rem;
      background-color: #007acc;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button#backBtn:hover {
      background-color: #005a9e;
    }
    /* Responsive */
    @media (max-width: 600px) {
      header {
        font-size: 1.2rem;
      }
      #songlist th, #songlist td {
        font-size: 0.9rem;
      }
      button#backBtn {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <header>Songliste</header>
  
  <div id="songlist">
    <table>
      <thead>
        <tr><th>#</th><th>Song</th><th>Interpret</th></tr>
      </thead>
      <tbody id="songTableBody">
        <!-- Dynamisch befüllt -->
      </tbody>
    </table>
  </div>
  
  <div id="songdetail">
    <button id="backBtn">Zurück zur Liste</button>
    <h2 id="songTitle"></h2>
    <pre id="songText">Lade...</pre>
  </div>
  
  <script>
    // Beispiel-Songliste, die du auch per fetch von JSON laden kannst
    const songs = [
      { id: 1, title: "The Bard's Song", artist: "Blind Guardian" },
      { id: 2, title: "An irgendeinem Tag wird die Welt…", artist: "Kapelle Petra" },
      { id: 3, title: "The Cave", artist: "Mumford and Sons" }
      // mehr Songs hier...
    ];

    const songListEl = document.getElementById('songlist');
    const songTableBody = document.getElementById('songTableBody');
    const songDetailEl = document.getElementById('songdetail');
    const backBtn = document.getElementById('backBtn');
    const songTitleEl = document.getElementById('songTitle');
    const songTextEl = document.getElementById('songText');

    // Liste füllen
    function fillSongList() {
      songTableBody.innerHTML = '';
      songs.forEach(song => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${song.id}</td><td>${song.title}</td><td>${song.artist}</td>`;
        tr.addEventListener('click', () => loadSong(song.id));
        songTableBody.appendChild(tr);
      });
    }

    // Song laden und anzeigen
    function loadSong(id) {
      const song = songs.find(s => s.id === id);
      if (!song) return alert('Song nicht gefunden.');

      // UI umschalten
      songListEl.style.display = 'none';
      songDetailEl.style.display = 'block';
      songTitleEl.textContent = `${song.title} – ${song.artist}`;
      songTextEl.textContent = 'Lade...';

      // URL-Hash setzen
      location.hash = 'song=' + id;

      // Songtext laden (im Ordner "songs" => "1.txt" etc.)
      fetch(`songs/${id}.txt`)
        .then(response => {
          if (!response.ok) throw new Error('Datei nicht gefunden.');
          return response.text();
        })
        .then(text => {
          songTextEl.textContent = text;
        })
        .catch(err => {
          songTextEl.textContent = 'Fehler beim Laden des Songs: ' + err.message;
        });
    }

    // Zurück zur Liste
    backBtn.addEventListener('click', () => {
      songDetailEl.style.display = 'none';
      songListEl.style.display = 'block';
      songTextEl.textContent = '';
      songTitleEl.textContent = '';
      location.hash = '';
    });

    // Beim Laden prüfen, ob URL-Hash einen Song vorgibt
    function checkHash() {
      if (location.hash.startsWith('#song=')) {
        const id = parseInt(location.hash.replace('#song=', ''), 10);
        if (!isNaN(id)) {
          loadSong(id);
          return;
        }
      }
      // Default: Liste anzeigen
      songDetailEl.style.display = 'none';
      songListEl.style.display = 'block';
    }

    // Initialisieren
    fillSongList();
    checkHash();

    // Wenn Hash sich ändert (Back/Forward Browser Buttons)
    window.addEventListener('hashchange', checkHash);

  </script>
</body>
</html>
